

============================== 2025-03-15 07:16:21.558562 | 310ef2e1-82e1-48b9-8f91-112c47ee2491 ==============================
[0m07:16:21.558562 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:16:21.562621 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:16:21.564573 [debug] [MainThread]: Tracking: tracking
[0m07:16:21.573738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2ac90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2ac97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2ac9390>]}
[0m07:16:21.592175 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:16:21.599019 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:16:21.600728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2ac97e0>]}
[0m07:16:22.549238 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m07:16:22.564879 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m07:16:22.570617 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m07:16:22.577211 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m07:16:22.772242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df11b5750>]}
[0m07:16:22.795340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df11f3880>]}
[0m07:16:22.797395 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:16:22.799071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df11d1540>]}
[0m07:16:22.802789 [info ] [MainThread]: 
[0m07:16:22.806913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:22.810757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:16:22.828133 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:16:22.830560 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:16:22.832119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:22.931652 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:16:22.934192 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:16:22.937905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:16:22.947539 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:16:22.948993 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:16:22.949975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:22.965992 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:16:22.967576 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:16:22.968574 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:16:22.977689 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:16:22.979662 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:16:22.982154 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:16:22.990038 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:22.991588 [debug] [MainThread]: On master: BEGIN
[0m07:16:22.992564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:23.009513 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:16:23.011393 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:23.012820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:23.020991 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:16:23.023885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df1233730>]}
[0m07:16:23.025454 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:23.028714 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:23.030731 [debug] [MainThread]: On master: BEGIN
[0m07:16:23.035117 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:16:23.036705 [debug] [MainThread]: On master: COMMIT
[0m07:16:23.037895 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:23.038826 [debug] [MainThread]: On master: COMMIT
[0m07:16:23.041486 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:16:23.042923 [debug] [MainThread]: On master: Close
[0m07:16:23.044995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:23.046732 [info ] [MainThread]: 
[0m07:16:23.068646 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:16:23.069995 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:16:23.071531 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:16:23.072627 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:16:23.078007 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:16:23.098423 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:16:23.073847 => 2025-03-15 07:16:23.098144
[0m07:16:23.099558 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:16:23.148705 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:16:23.167712 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:16:23.168658 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:16:23.169495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:23.189138 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:16:23.190397 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:16:23.191530 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:16:23.196417 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:16:23.198182 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:16:23.201207 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:16:23.100499 => 2025-03-15 07:16:23.201073
[0m07:16:23.202598 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:16:23.213134 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:16:23.215291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df00900d0>]}
[0m07:16:23.217007 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m07:16:23.221094 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:16:23.222810 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:16:23.224678 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:16:23.227244 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:16:23.229883 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:16:23.237868 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:16:23.252459 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:16:23.233130 => 2025-03-15 07:16:23.252112
[0m07:16:23.254128 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:16:23.263470 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:16:23.277663 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:16:23.279756 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:16:23.281147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:23.317545 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:16:23.318928 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:16:23.320269 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:16:23.324742 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:16:23.326214 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:16:23.329563 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:16:23.255504 => 2025-03-15 07:16:23.329349
[0m07:16:23.332092 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:16:23.334574 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:16:23.337040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df1187b80>]}
[0m07:16:23.340650 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.11s]
[0m07:16:23.346726 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:16:23.352285 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:16:23.355874 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:16:23.358685 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:16:23.360884 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:16:23.367432 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:16:23.383748 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:16:23.362604 => 2025-03-15 07:16:23.383317
[0m07:16:23.389595 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:16:23.397717 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:16:23.421814 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:16:23.423133 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:16:23.424120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:23.444167 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:16:23.446869 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:16:23.448277 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:16:23.451046 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:16:23.452182 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:16:23.455096 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:16:23.391116 => 2025-03-15 07:16:23.454955
[0m07:16:23.456432 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:16:23.458326 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:16:23.459872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310ef2e1-82e1-48b9-8f91-112c47ee2491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df00e4a00>]}
[0m07:16:23.462276 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.10s]
[0m07:16:23.464115 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:16:23.465979 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:16:23.466978 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:16:23.468272 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:16:23.471293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:23.472790 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:23.473686 [debug] [MainThread]: On master: BEGIN
[0m07:16:23.474744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:16:23.494111 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:16:23.495668 [debug] [MainThread]: On master: COMMIT
[0m07:16:23.497350 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:23.498369 [debug] [MainThread]: On master: COMMIT
[0m07:16:23.501092 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:16:23.502321 [debug] [MainThread]: On master: Close
[0m07:16:23.504366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:16:23.506208 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:16:23.507889 [info ] [MainThread]: 
[0m07:16:23.509252 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m07:16:23.510999 [debug] [MainThread]: Command end result
[0m07:16:23.532019 [info ] [MainThread]: 
[0m07:16:23.533585 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:16:23.535016 [info ] [MainThread]: 
[0m07:16:23.536740 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:16:23.538822 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:16:23.540184 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:16:23.541500 [error] [MainThread]:                             ^
[0m07:16:23.543156 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:16:23.545673 [info ] [MainThread]: 
[0m07:16:23.547454 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:16:23.549064 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:16:23.550524 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:16:23.552255 [error] [MainThread]:                             ^
[0m07:16:23.553866 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:16:23.555471 [info ] [MainThread]: 
[0m07:16:23.557061 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:16:23.558577 [error] [MainThread]:   relation "public.films" does not exist
[0m07:16:23.559775 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:16:23.560834 [error] [MainThread]:                             ^
[0m07:16:23.561929 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:16:23.563361 [info ] [MainThread]: 
[0m07:16:23.564714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:16:23.566143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df0090550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2acbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df2ac8820>]}
[0m07:16:23.567492 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:24:20.175869 | e98a1931-9904-4080-8197-945e31e35ecb ==============================
[0m07:24:20.175869 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:24:20.178999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:24:20.182029 [debug] [MainThread]: Tracking: tracking
[0m07:24:20.191737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee86399360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee863997e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee863993c0>]}
[0m07:24:20.213467 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:24:20.440591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:24:20.442194 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m07:24:20.443400 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m07:24:20.444513 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m07:24:20.470335 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m07:24:20.487414 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m07:24:20.493070 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m07:24:20.579033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee77129e10>]}
[0m07:24:20.600939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee863b0910>]}
[0m07:24:20.602337 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:24:20.605061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84ab6110>]}
[0m07:24:20.609193 [info ] [MainThread]: 
[0m07:24:20.613454 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:24:20.616525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:24:20.632723 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:24:20.634268 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:24:20.635482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:20.671765 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:24:20.674335 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:24:20.677769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:24:20.685295 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:24:20.686462 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:24:20.687582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:20.704396 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:24:20.705656 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:24:20.706818 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:24:20.712202 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:24:20.714539 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:24:20.716695 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:24:20.723854 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:20.725148 [debug] [MainThread]: On master: BEGIN
[0m07:24:20.726521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:24:20.753268 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:24:20.754769 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:20.755928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:24:20.763436 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:24:20.765964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee77143820>]}
[0m07:24:20.767221 [debug] [MainThread]: On master: ROLLBACK
[0m07:24:20.771477 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:20.772958 [debug] [MainThread]: On master: BEGIN
[0m07:24:20.777135 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:24:20.778375 [debug] [MainThread]: On master: COMMIT
[0m07:24:20.779358 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:20.780370 [debug] [MainThread]: On master: COMMIT
[0m07:24:20.783157 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:24:20.784767 [debug] [MainThread]: On master: Close
[0m07:24:20.786375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:24:20.788308 [info ] [MainThread]: 
[0m07:24:20.816533 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:24:20.818339 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:24:20.820129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:24:20.821347 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:24:20.826816 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:24:20.838033 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:24:20.822547 => 2025-03-15 07:24:20.837869
[0m07:24:20.839325 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:24:20.891175 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:24:20.903166 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:24:20.904054 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:24:20.904931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:20.919433 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:24:20.920569 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:24:20.921546 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:24:20.925625 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:24:20.926749 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:24:20.929195 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:24:20.840264 => 2025-03-15 07:24:20.929096
[0m07:24:20.930275 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:24:20.938572 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:24:20.940253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84aedb10>]}
[0m07:24:20.941593 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.12s]
[0m07:24:20.945046 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:24:20.946184 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:24:20.947370 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:24:20.949317 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:24:20.950291 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:24:20.954849 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:24:20.963922 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:24:20.951208 => 2025-03-15 07:24:20.963762
[0m07:24:20.965164 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:24:20.972712 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:24:20.982260 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:24:20.983504 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:24:20.984645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:21.002087 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:24:21.003422 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:24:21.004613 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:24:21.007423 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:24:21.008586 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:24:21.010783 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:24:20.966076 => 2025-03-15 07:24:21.010688
[0m07:24:21.011678 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:24:21.013749 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:24:21.015172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee76fff9a0>]}
[0m07:24:21.016422 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m07:24:21.017746 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:24:21.018934 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:24:21.019986 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:24:21.021357 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:24:21.022248 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:24:21.027369 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:24:21.038057 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:24:21.023124 => 2025-03-15 07:24:21.037745
[0m07:24:21.039755 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:24:21.046383 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:24:21.055487 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:24:21.056503 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:24:21.057535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:21.076246 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:24:21.077572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:24:21.078533 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:24:21.080866 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:24:21.081929 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:24:21.084219 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:24:21.040777 => 2025-03-15 07:24:21.084131
[0m07:24:21.085175 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:24:21.087336 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:24:21.088441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e98a1931-9904-4080-8197-945e31e35ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84aec460>]}
[0m07:24:21.089619 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m07:24:21.091010 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:24:21.092972 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:24:21.094290 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:24:21.095589 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:24:21.097972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:24:21.099283 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:21.100376 [debug] [MainThread]: On master: BEGIN
[0m07:24:21.101227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:24:21.119263 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:24:21.120375 [debug] [MainThread]: On master: COMMIT
[0m07:24:21.121391 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:21.122341 [debug] [MainThread]: On master: COMMIT
[0m07:24:21.124637 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:24:21.125907 [debug] [MainThread]: On master: Close
[0m07:24:21.127926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:21.131291 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:24:21.132784 [info ] [MainThread]: 
[0m07:24:21.134007 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m07:24:21.135564 [debug] [MainThread]: Command end result
[0m07:24:21.157747 [info ] [MainThread]: 
[0m07:24:21.159437 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:24:21.160857 [info ] [MainThread]: 
[0m07:24:21.162158 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:24:21.164131 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:24:21.165462 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:24:21.166575 [error] [MainThread]:                             ^
[0m07:24:21.168258 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:24:21.169823 [info ] [MainThread]: 
[0m07:24:21.171498 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:24:21.173019 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:24:21.174746 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:24:21.176068 [error] [MainThread]:                             ^
[0m07:24:21.177615 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:24:21.179139 [info ] [MainThread]: 
[0m07:24:21.180403 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:24:21.181474 [error] [MainThread]:   relation "public.films" does not exist
[0m07:24:21.182595 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:24:21.185017 [error] [MainThread]:                             ^
[0m07:24:21.186204 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:24:21.187470 [info ] [MainThread]: 
[0m07:24:21.188780 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:24:21.190170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8636dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8636dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee86363040>]}
[0m07:24:21.191217 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:33:20.409355 | 4b923aac-0616-4b66-9925-0f7644212cf4 ==============================
[0m07:33:20.409355 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:33:20.413180 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:33:20.414542 [debug] [MainThread]: Tracking: tracking
[0m07:33:20.425127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2626d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2626d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2626d390>]}
[0m07:33:20.455660 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:33:20.676821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:20.678859 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:20.691482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2499cc40>]}
[0m07:33:20.713175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed24ae2260>]}
[0m07:33:20.714574 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:33:20.715792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed24ae22c0>]}
[0m07:33:20.720055 [info ] [MainThread]: 
[0m07:33:20.724330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:33:20.727534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:33:20.743559 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:33:20.745445 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:33:20.746760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:20.785619 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:33:20.789297 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:33:20.792325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:33:20.801118 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:33:20.802366 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:33:20.803309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:20.818440 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:33:20.819708 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:33:20.820704 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:33:20.826915 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:33:20.829473 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:33:20.832217 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:33:20.839519 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:20.841704 [debug] [MainThread]: On master: BEGIN
[0m07:33:20.844458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:20.860158 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:33:20.861711 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:20.862707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:33:20.869356 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:33:20.872176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed249e78b0>]}
[0m07:33:20.873621 [debug] [MainThread]: On master: ROLLBACK
[0m07:33:20.876409 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:20.877521 [debug] [MainThread]: On master: BEGIN
[0m07:33:20.881224 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:33:20.882858 [debug] [MainThread]: On master: COMMIT
[0m07:33:20.883829 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:20.884650 [debug] [MainThread]: On master: COMMIT
[0m07:33:20.887462 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:33:20.888587 [debug] [MainThread]: On master: Close
[0m07:33:20.890798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:33:20.892615 [info ] [MainThread]: 
[0m07:33:20.914662 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:33:20.915928 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:33:20.917678 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:33:20.918649 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:33:20.923576 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:33:20.931546 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:33:20.919628 => 2025-03-15 07:33:20.931368
[0m07:33:20.932613 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:33:20.977954 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:33:20.986043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:33:20.986983 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:33:20.987747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:21.002253 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:33:21.003484 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:33:21.004399 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:33:21.008599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:33:21.009859 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:33:21.012369 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:33:20.933383 => 2025-03-15 07:33:21.012263
[0m07:33:21.013385 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:33:21.023381 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:33:21.025352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2482a890>]}
[0m07:33:21.026873 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m07:33:21.030405 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:33:21.033075 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:33:21.034278 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:33:21.035925 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:33:21.037056 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:33:21.043220 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:33:21.052907 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:33:21.037980 => 2025-03-15 07:33:21.052696
[0m07:33:21.054291 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:33:21.060182 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:33:21.069956 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:33:21.071017 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:33:21.071925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:21.089219 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:33:21.090414 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:33:21.091432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:33:21.094070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:33:21.095182 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:33:21.097383 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:33:21.055246 => 2025-03-15 07:33:21.097279
[0m07:33:21.098333 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:33:21.100043 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:33:21.101439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed248545e0>]}
[0m07:33:21.102595 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m07:33:21.103794 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:33:21.104752 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:33:21.105705 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:33:21.107430 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:33:21.108726 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:33:21.113296 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:33:21.122158 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:33:21.109588 => 2025-03-15 07:33:21.121942
[0m07:33:21.123371 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:33:21.129431 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:33:21.138593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:33:21.139526 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:33:21.140479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:21.158382 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:33:21.159516 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:33:21.160412 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:33:21.163075 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:33:21.164080 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:33:21.166096 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:33:21.124256 => 2025-03-15 07:33:21.166013
[0m07:33:21.166899 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:33:21.168833 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:33:21.170134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b923aac-0616-4b66-9925-0f7644212cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed249f3ac0>]}
[0m07:33:21.171529 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m07:33:21.172798 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:33:21.175193 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:33:21.176432 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:33:21.177634 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:33:21.179919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:33:21.181009 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:21.181852 [debug] [MainThread]: On master: BEGIN
[0m07:33:21.182626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:33:21.201344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:33:21.202908 [debug] [MainThread]: On master: COMMIT
[0m07:33:21.203821 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:21.204689 [debug] [MainThread]: On master: COMMIT
[0m07:33:21.207084 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:33:21.208593 [debug] [MainThread]: On master: Close
[0m07:33:21.210188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:21.211172 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:33:21.212209 [info ] [MainThread]: 
[0m07:33:21.213607 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m07:33:21.215308 [debug] [MainThread]: Command end result
[0m07:33:21.232784 [info ] [MainThread]: 
[0m07:33:21.234549 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:33:21.235753 [info ] [MainThread]: 
[0m07:33:21.236948 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:33:21.238230 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:33:21.239493 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:33:21.241123 [error] [MainThread]:                             ^
[0m07:33:21.242442 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:33:21.243756 [info ] [MainThread]: 
[0m07:33:21.245096 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:33:21.246376 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:33:21.247508 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:33:21.248652 [error] [MainThread]:                             ^
[0m07:33:21.249839 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:33:21.251150 [info ] [MainThread]: 
[0m07:33:21.252388 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:33:21.253482 [error] [MainThread]:   relation "public.films" does not exist
[0m07:33:21.254474 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:33:21.255419 [error] [MainThread]:                             ^
[0m07:33:21.256418 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:33:21.257416 [info ] [MainThread]: 
[0m07:33:21.258627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:33:21.259968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed249e77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed249e78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed24855f00>]}
[0m07:33:21.261222 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:37:46.330932 | 39858754-ba38-4a22-9592-6970ad8e56cf ==============================
[0m07:37:46.330932 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:37:46.333798 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:37:46.335236 [debug] [MainThread]: Tracking: tracking
[0m07:37:46.344348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f43dd50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f43dd57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f43dd5390>]}
[0m07:37:46.371088 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:37:46.580783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:46.582027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:46.592401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f42504c70>]}
[0m07:37:46.612582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f4264a290>]}
[0m07:37:46.613715 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:37:46.614854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f4264a2f0>]}
[0m07:37:46.618095 [info ] [MainThread]: 
[0m07:37:46.621802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:46.624383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:37:46.638856 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:37:46.640155 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:37:46.641384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:46.675176 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:37:46.677704 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:37:46.680667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:37:46.689440 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:37:46.690552 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:37:46.691619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:46.706455 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:37:46.707781 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:37:46.709361 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:37:46.715375 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:37:46.717498 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:37:46.720010 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:37:46.726327 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:46.727522 [debug] [MainThread]: On master: BEGIN
[0m07:37:46.728479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:46.742546 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:37:46.743855 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:46.744851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:46.751487 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:37:46.753716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f425538b0>]}
[0m07:37:46.754827 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:46.757100 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:46.757988 [debug] [MainThread]: On master: BEGIN
[0m07:37:46.761244 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:37:46.762426 [debug] [MainThread]: On master: COMMIT
[0m07:37:46.763251 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:46.764101 [debug] [MainThread]: On master: COMMIT
[0m07:37:46.766074 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:37:46.767069 [debug] [MainThread]: On master: Close
[0m07:37:46.768527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:46.769585 [info ] [MainThread]: 
[0m07:37:46.790332 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:37:46.791853 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:37:46.793410 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:37:46.794402 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:37:46.799103 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:37:46.806887 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:37:46.795439 => 2025-03-15 07:37:46.806773
[0m07:37:46.808164 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:37:46.853810 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:37:46.862875 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:37:46.863815 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:37:46.864705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:46.879496 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:37:46.880790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:37:46.881682 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:37:46.885352 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:37:46.886541 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:37:46.888919 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:37:46.809144 => 2025-03-15 07:37:46.888824
[0m07:37:46.889782 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:37:46.897710 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:37:46.898975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f423aa890>]}
[0m07:37:46.900195 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m07:37:46.902885 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:37:46.904021 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:37:46.905083 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:37:46.906906 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:37:46.908082 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:37:46.913895 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:37:46.923793 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:37:46.909074 => 2025-03-15 07:37:46.923591
[0m07:37:46.925459 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:37:46.932120 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:37:46.942897 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:37:46.943967 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:37:46.944837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:46.964784 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:37:46.966105 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:37:46.967156 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:37:46.970415 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:37:46.971574 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:37:46.973728 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:37:46.926303 => 2025-03-15 07:37:46.973640
[0m07:37:46.974848 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:37:46.976803 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:37:46.978189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f423c0610>]}
[0m07:37:46.979626 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m07:37:46.981288 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:37:46.982338 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:37:46.983352 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:37:46.984864 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:37:46.985878 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:37:46.990466 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:37:46.999567 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:37:46.987038 => 2025-03-15 07:37:46.999416
[0m07:37:47.000680 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:37:47.006872 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:37:47.017911 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:37:47.019105 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:37:47.020020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:47.037511 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:37:47.039168 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:37:47.040389 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:37:47.043850 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:37:47.045071 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:37:47.048150 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:37:47.001544 => 2025-03-15 07:37:47.048002
[0m07:37:47.049748 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:37:47.052969 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:37:47.055704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39858754-ba38-4a22-9592-6970ad8e56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f4255fac0>]}
[0m07:37:47.058358 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m07:37:47.060088 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:37:47.063736 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:37:47.065702 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:37:47.067766 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:37:47.070971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:47.074443 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:47.077365 [debug] [MainThread]: On master: BEGIN
[0m07:37:47.080783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:37:47.113434 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:37:47.114970 [debug] [MainThread]: On master: COMMIT
[0m07:37:47.116216 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:47.117659 [debug] [MainThread]: On master: COMMIT
[0m07:37:47.120912 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:37:47.122362 [debug] [MainThread]: On master: Close
[0m07:37:47.124335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:47.125524 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:37:47.127514 [info ] [MainThread]: 
[0m07:37:47.129622 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m07:37:47.131326 [debug] [MainThread]: Command end result
[0m07:37:47.161524 [info ] [MainThread]: 
[0m07:37:47.163108 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:37:47.164536 [info ] [MainThread]: 
[0m07:37:47.165975 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:37:47.167350 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:37:47.168769 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:37:47.170454 [error] [MainThread]:                             ^
[0m07:37:47.172942 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:37:47.174383 [info ] [MainThread]: 
[0m07:37:47.176125 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:37:47.179945 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:37:47.182038 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:37:47.183529 [error] [MainThread]:                             ^
[0m07:37:47.184977 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:37:47.186959 [info ] [MainThread]: 
[0m07:37:47.189638 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:37:47.191041 [error] [MainThread]:   relation "public.films" does not exist
[0m07:37:47.192499 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:37:47.193883 [error] [MainThread]:                             ^
[0m07:37:47.195127 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:37:47.196313 [info ] [MainThread]: 
[0m07:37:47.197668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:37:47.198935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f423c0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f423c2fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f425537c0>]}
[0m07:37:47.200117 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:42:00.911662 | f90ccbd0-8a26-40b3-a239-4becfb987e2e ==============================
[0m07:42:00.911662 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:42:00.914824 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:42:00.916131 [debug] [MainThread]: Tracking: tracking
[0m07:42:00.924810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58ab310f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58ab317b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58ab31390>]}
[0m07:42:00.944204 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:42:01.132898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:01.134032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:01.145099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb589274c40>]}
[0m07:42:01.165590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5891be260>]}
[0m07:42:01.166676 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:42:01.168031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5891be2c0>]}
[0m07:42:01.174727 [info ] [MainThread]: 
[0m07:42:01.178958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:01.182212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:42:01.196205 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:42:01.197496 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:42:01.198534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:01.238646 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:42:01.241151 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:42:01.244006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:42:01.251986 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:42:01.253917 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:42:01.255021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:01.271730 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:42:01.272944 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:42:01.273889 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:42:01.281544 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:42:01.284415 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:42:01.287263 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:42:01.295038 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.296881 [debug] [MainThread]: On master: BEGIN
[0m07:42:01.297781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:01.313874 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:01.315629 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.316618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:01.322443 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:42:01.323019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5890bf8b0>]}
[0m07:42:01.324128 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:01.326233 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.327049 [debug] [MainThread]: On master: BEGIN
[0m07:42:01.330370 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:01.331585 [debug] [MainThread]: On master: COMMIT
[0m07:42:01.332610 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.333830 [debug] [MainThread]: On master: COMMIT
[0m07:42:01.336370 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:42:01.337312 [debug] [MainThread]: On master: Close
[0m07:42:01.338580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:01.339704 [info ] [MainThread]: 
[0m07:42:01.359117 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:42:01.361168 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:42:01.362935 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:42:01.364189 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:42:01.368571 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:42:01.377315 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:42:01.365181 => 2025-03-15 07:42:01.377134
[0m07:42:01.378423 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:42:01.425879 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:42:01.433900 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:01.434909 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:42:01.435717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:01.449914 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:01.451021 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:01.451797 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:42:01.456428 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:42:01.457571 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:42:01.459671 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:42:01.379259 => 2025-03-15 07:42:01.459584
[0m07:42:01.460519 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:42:01.468899 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:42:01.470322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58911a890>]}
[0m07:42:01.471734 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m07:42:01.474583 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:42:01.476055 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:42:01.477079 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:42:01.478405 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:42:01.479365 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:42:01.484950 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:42:01.494111 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:42:01.480261 => 2025-03-15 07:42:01.493975
[0m07:42:01.495258 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:42:01.501169 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:42:01.510083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:01.511291 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:42:01.512307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:01.528508 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:01.530236 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:01.531276 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:42:01.534260 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:42:01.535289 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:42:01.537414 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:42:01.496136 => 2025-03-15 07:42:01.537303
[0m07:42:01.538441 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:42:01.540179 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:42:01.541405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58912c5e0>]}
[0m07:42:01.542645 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m07:42:01.543844 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:42:01.545573 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:42:01.546771 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:42:01.548611 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:42:01.549552 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:42:01.553307 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:42:01.562254 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:42:01.550344 => 2025-03-15 07:42:01.562056
[0m07:42:01.563336 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:42:01.569283 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:42:01.578532 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:01.579526 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:42:01.580592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:01.597349 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:01.598476 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:01.599597 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:42:01.602384 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:42:01.603335 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:42:01.605411 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:42:01.564119 => 2025-03-15 07:42:01.605310
[0m07:42:01.606475 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:42:01.608503 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:42:01.609808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90ccbd0-8a26-40b3-a239-4becfb987e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5890cbac0>]}
[0m07:42:01.611105 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m07:42:01.613318 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:42:01.615407 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:42:01.616429 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:42:01.617702 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:42:01.619828 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:01.621039 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.622087 [debug] [MainThread]: On master: BEGIN
[0m07:42:01.623017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:01.637903 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:01.639250 [debug] [MainThread]: On master: COMMIT
[0m07:42:01.640251 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.641182 [debug] [MainThread]: On master: COMMIT
[0m07:42:01.643714 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:42:01.644652 [debug] [MainThread]: On master: Close
[0m07:42:01.646587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:01.647898 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:42:01.649124 [info ] [MainThread]: 
[0m07:42:01.650823 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m07:42:01.652575 [debug] [MainThread]: Command end result
[0m07:42:01.672599 [info ] [MainThread]: 
[0m07:42:01.674006 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:42:01.675090 [info ] [MainThread]: 
[0m07:42:01.676332 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:42:01.677487 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:42:01.678821 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:42:01.680118 [error] [MainThread]:                             ^
[0m07:42:01.682629 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:42:01.685007 [info ] [MainThread]: 
[0m07:42:01.686366 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:42:01.687834 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:42:01.689116 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:42:01.690287 [error] [MainThread]:                             ^
[0m07:42:01.691835 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:42:01.694399 [info ] [MainThread]: 
[0m07:42:01.696148 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:42:01.697525 [error] [MainThread]:   relation "public.films" does not exist
[0m07:42:01.698887 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:42:01.700244 [error] [MainThread]:                             ^
[0m07:42:01.701874 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:42:01.703737 [info ] [MainThread]: 
[0m07:42:01.705146 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:42:01.706677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5890bf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5890bf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58912df00>]}
[0m07:42:01.708198 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:42:29.084923 | e81a300f-ec02-4614-8cd0-3bb9943e0719 ==============================
[0m07:42:29.084923 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:42:29.088400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:42:29.089446 [debug] [MainThread]: Tracking: tracking
[0m07:42:29.092610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0eb5e8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0eb5eb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0eb5e8b20>]}
[0m07:42:29.116825 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:42:29.303828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:29.305444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:29.316073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9c9caf0>]}
[0m07:42:29.342732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9d56110>]}
[0m07:42:29.345812 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:42:29.347465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9d56170>]}
[0m07:42:29.351665 [info ] [MainThread]: 
[0m07:42:29.355915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:29.360235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:42:29.378859 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:42:29.380343 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:42:29.381592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:29.405430 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:42:29.408540 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:42:29.412392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:42:29.422580 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:42:29.424041 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:42:29.425136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:29.442197 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:42:29.443935 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:42:29.445211 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:42:29.455596 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:42:29.459780 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:42:29.463171 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:42:29.475522 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:29.476981 [debug] [MainThread]: On master: BEGIN
[0m07:42:29.478252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:29.499611 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:29.501158 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:29.502463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:29.511648 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:42:29.514538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9ce38b0>]}
[0m07:42:29.515980 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:29.518856 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:29.520202 [debug] [MainThread]: On master: BEGIN
[0m07:42:29.524817 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:29.526210 [debug] [MainThread]: On master: COMMIT
[0m07:42:29.527220 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:29.528290 [debug] [MainThread]: On master: COMMIT
[0m07:42:29.530635 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:42:29.531826 [debug] [MainThread]: On master: Close
[0m07:42:29.533777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:29.536544 [info ] [MainThread]: 
[0m07:42:29.544649 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:42:29.546836 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:42:29.548811 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:42:29.550264 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:42:29.555847 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:42:29.565293 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:42:29.551392 => 2025-03-15 07:42:29.564965
[0m07:42:29.566676 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:42:29.625352 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:42:29.634906 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.636447 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:42:29.637575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:29.655444 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:29.656870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.657831 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:42:29.663666 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:42:29.674703 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.676281 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:42:29.679410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.685168 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.686491 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:42:29.689203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.715317 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:42:29.716571 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.717353 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:42:29.720162 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:42:29.726488 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:42:29.727596 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:42:29.732386 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:42:29.734842 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:42:29.567648 => 2025-03-15 07:42:29.734722
[0m07:42:29.736244 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:42:29.737930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9d01bd0>]}
[0m07:42:29.741545 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.19s]
[0m07:42:29.744625 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:42:29.745649 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:42:29.746587 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:42:29.748161 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:42:29.749204 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:42:29.753555 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:42:29.761677 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:42:29.750001 => 2025-03-15 07:42:29.761530
[0m07:42:29.762739 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:42:29.768570 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:42:29.776921 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.777863 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:42:29.778840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:29.793712 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:29.794897 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.795716 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:42:29.799238 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:42:29.804326 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.805394 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:42:29.807832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.811675 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.813264 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:42:29.815892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.819261 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:42:29.820369 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.821226 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:42:29.824616 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:42:29.827995 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:42:29.829432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:42:29.834009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:42:29.836627 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:42:29.763580 => 2025-03-15 07:42:29.836562
[0m07:42:29.837630 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:42:29.839056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9ce3280>]}
[0m07:42:29.840249 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m07:42:29.841516 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:42:29.842899 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:42:29.844472 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:42:29.846361 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:42:29.847271 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:42:29.852735 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:42:29.862040 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:42:29.848074 => 2025-03-15 07:42:29.861865
[0m07:42:29.863005 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:42:29.869195 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:42:29.878280 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.879227 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:42:29.880018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:29.893293 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:29.894529 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.895381 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:42:29.898464 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:42:29.903117 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.904391 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:42:29.906867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.910956 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.912088 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:42:29.914917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:42:29.918099 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:42:29.919176 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.920133 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:42:29.922740 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:42:29.926131 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:42:29.927111 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:42:29.931089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:42:29.933260 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:42:29.863865 => 2025-03-15 07:42:29.933203
[0m07:42:29.934314 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:42:29.936234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9b4c490>]}
[0m07:42:29.939392 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m07:42:29.940746 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:42:29.942658 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:42:29.943722 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:42:29.945256 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:42:29.946400 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:42:29.952016 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:42:29.960454 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-03-15 07:42:29.947361 => 2025-03-15 07:42:29.960325
[0m07:42:29.961485 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:42:29.967160 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:42:29.976954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:42:29.977932 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:42:29.978825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:29.992585 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:42:29.993812 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:42:29.994714 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT 
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id;
  );
  
[0m07:42:29.997443 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 40: ...EFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id;
                                                                       ^

[0m07:42:29.998512 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m07:42:30.000976 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-03-15 07:42:29.962304 => 2025-03-15 07:42:30.000821
[0m07:42:30.002488 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:42:30.006784 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near ";"
  LINE 40: ...EFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id;
                                                                         ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m07:42:30.008614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81a300f-ec02-4614-8cd0-3bb9943e0719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9be7dc0>]}
[0m07:42:30.009931 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.06s]
[0m07:42:30.011369 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:42:30.015249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:30.016642 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:30.017545 [debug] [MainThread]: On master: BEGIN
[0m07:42:30.018403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:30.034747 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:42:30.036624 [debug] [MainThread]: On master: COMMIT
[0m07:42:30.037730 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:30.038728 [debug] [MainThread]: On master: COMMIT
[0m07:42:30.041059 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:42:30.042072 [debug] [MainThread]: On master: Close
[0m07:42:30.043857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:30.045392 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:42:30.046537 [info ] [MainThread]: 
[0m07:42:30.047825 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m07:42:30.049374 [debug] [MainThread]: Command end result
[0m07:42:30.070670 [info ] [MainThread]: 
[0m07:42:30.072338 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:42:30.073952 [info ] [MainThread]: 
[0m07:42:30.075719 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m07:42:30.077240 [error] [MainThread]:   syntax error at or near ";"
[0m07:42:30.078525 [error] [MainThread]:   LINE 40: ...EFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id;
[0m07:42:30.079961 [error] [MainThread]:                                                                          ^
[0m07:42:30.081128 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m07:42:30.082243 [info ] [MainThread]: 
[0m07:42:30.083447 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m07:42:30.085429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9b2e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9b2f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e9b2cdf0>]}
[0m07:42:30.086641 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 07:43:45.208343 | 0a2d168f-a5d3-4587-a0a8-919ef98ad906 ==============================
[0m07:43:45.208343 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:43:45.211002 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:43:45.212156 [debug] [MainThread]: Tracking: tracking
[0m07:43:45.220376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97edd28b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97edd2b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97edd28af0>]}
[0m07:43:45.242506 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:43:45.442544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:43:45.443798 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m07:43:45.470100 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m07:43:45.553636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97eaa3feb0>]}
[0m07:43:45.574146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97edc7a350>]}
[0m07:43:45.575280 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:43:45.576829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ef6b5b70>]}
[0m07:43:45.580321 [info ] [MainThread]: 
[0m07:43:45.584312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:45.586808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:43:45.600956 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:43:45.602629 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:43:45.603692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:45.644903 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:43:45.647375 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:43:45.650464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:43:45.658773 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:43:45.659983 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:43:45.660879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:45.676773 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:43:45.678012 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:43:45.678890 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:43:45.691675 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:43:45.694450 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:43:45.697689 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:43:45.707846 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:45.709188 [debug] [MainThread]: On master: BEGIN
[0m07:43:45.710197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:45.723861 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:43:45.725101 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:45.726158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:45.736935 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:43:45.739214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec412680>]}
[0m07:43:45.740449 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:45.742885 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:45.744344 [debug] [MainThread]: On master: BEGIN
[0m07:43:45.748919 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:43:45.750407 [debug] [MainThread]: On master: COMMIT
[0m07:43:45.751354 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:45.752229 [debug] [MainThread]: On master: COMMIT
[0m07:43:45.754801 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:43:45.756109 [debug] [MainThread]: On master: Close
[0m07:43:45.758004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:45.759140 [info ] [MainThread]: 
[0m07:43:45.765722 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:43:45.767285 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:43:45.770169 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:43:45.771228 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:43:45.775944 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:43:45.786035 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 07:43:45.772163 => 2025-03-15 07:43:45.785886
[0m07:43:45.787261 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:43:45.833851 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:43:45.843109 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.844059 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:43:45.844935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:45.859251 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:43:45.860364 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.861180 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:43:45.866468 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:43:45.875748 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.877083 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:43:45.880352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:45.884184 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.885314 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:43:45.888291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:45.914522 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:43:45.915778 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.916694 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:43:45.919728 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:43:45.925797 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:43:45.926892 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:43:45.930862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:43:45.933119 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 07:43:45.788106 => 2025-03-15 07:43:45.933056
[0m07:43:45.934175 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:43:45.936434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97eaa51720>]}
[0m07:43:45.937645 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.17s]
[0m07:43:45.940909 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:43:45.942106 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:43:45.943130 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:43:45.944690 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:43:45.945700 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:43:45.949920 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:43:45.958275 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 07:43:45.946488 => 2025-03-15 07:43:45.958138
[0m07:43:45.959537 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:43:45.965951 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:43:45.975030 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:45.975944 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:43:45.976689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:46.005753 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:43:46.010020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:46.011308 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:43:46.015407 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:43:46.020028 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:46.021494 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:43:46.027557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:46.034621 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:46.037046 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:43:46.042576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:46.047136 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:43:46.048630 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:46.049666 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:43:46.054695 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:43:46.058602 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:43:46.059809 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:43:46.063337 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:43:46.065550 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 07:43:45.960460 => 2025-03-15 07:43:46.065482
[0m07:43:46.066560 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:43:46.068115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97eaa51ab0>]}
[0m07:43:46.070551 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.12s]
[0m07:43:46.071850 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:43:46.073183 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:43:46.074290 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:43:46.076073 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:43:46.077169 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:43:46.082197 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:43:46.090598 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 07:43:46.078129 => 2025-03-15 07:43:46.090450
[0m07:43:46.091612 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:43:46.098170 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:43:46.107345 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.108747 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:43:46.109920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:46.125306 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:43:46.126443 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.127328 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:43:46.130938 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:43:46.136520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.137919 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:43:46.141056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:46.145741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.146892 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:43:46.150011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:46.154621 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:43:46.155710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.156488 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:43:46.159123 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:43:46.162603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:43:46.163480 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:43:46.167900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:43:46.170206 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 07:43:46.092380 => 2025-03-15 07:43:46.170143
[0m07:43:46.171173 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:43:46.172702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97eaa51720>]}
[0m07:43:46.173966 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.10s]
[0m07:43:46.176180 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:43:46.178322 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:43:46.179673 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:43:46.181014 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:43:46.181845 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:43:46.187659 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:43:46.195993 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-03-15 07:43:46.182684 => 2025-03-15 07:43:46.195859
[0m07:43:46.197040 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:43:46.202860 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:43:46.211774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:43:46.212759 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:43:46.213581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:46.229072 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:43:46.230212 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:43:46.231020 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m07:43:46.239724 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:43:46.246520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:43:46.247811 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:43:46.250436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:43:46.253593 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:43:46.254544 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:43:46.255340 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:43:46.258069 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:43:46.261107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:43:46.262083 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:43:46.264314 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:43:46.266478 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-03-15 07:43:46.197844 => 2025-03-15 07:43:46.266419
[0m07:43:46.267575 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:43:46.269221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2d168f-a5d3-4587-a0a8-919ef98ad906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ea9a1930>]}
[0m07:43:46.273415 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.09s]
[0m07:43:46.274532 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:43:46.276943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:46.277871 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:46.278658 [debug] [MainThread]: On master: BEGIN
[0m07:43:46.279773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:46.294615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:43:46.295999 [debug] [MainThread]: On master: COMMIT
[0m07:43:46.296932 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:46.297760 [debug] [MainThread]: On master: COMMIT
[0m07:43:46.300673 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:43:46.302047 [debug] [MainThread]: On master: Close
[0m07:43:46.303650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:46.304972 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:43:46.305981 [info ] [MainThread]: 
[0m07:43:46.307200 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m07:43:46.308632 [debug] [MainThread]: Command end result
[0m07:43:46.328702 [info ] [MainThread]: 
[0m07:43:46.330305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:46.332166 [info ] [MainThread]: 
[0m07:43:46.334729 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:43:46.338177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ea989de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec334040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ea9a2a40>]}
[0m07:43:46.340093 [debug] [MainThread]: Flushing usage events


============================== 2025-03-15 08:00:19.582884 | 882a1d7f-0039-4d4d-86d0-0254e25a675d ==============================
[0m08:00:19.582884 [info ] [MainThread]: Running with dbt=1.4.7
[0m08:00:19.585370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:00:19.586404 [debug] [MainThread]: Tracking: tracking
[0m08:00:19.594464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec9ce0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec9ce3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec9ce0af0>]}
[0m08:00:19.615839 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m08:00:19.804637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:00:19.805929 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_ratings_macro.sql
[0m08:00:19.806993 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m08:00:19.843215 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m08:00:19.861192 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m08:00:19.927299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec8394e20>]}
[0m08:00:19.944831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec84edd80>]}
[0m08:00:19.945846 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:00:19.946833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec8337d30>]}
[0m08:00:19.949915 [info ] [MainThread]: 
[0m08:00:19.953399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:19.955904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m08:00:19.968675 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m08:00:19.970022 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m08:00:19.971001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:20.010618 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:00:20.013043 [debug] [ThreadPool]: On list_destination_db: Close
[0m08:00:20.015836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m08:00:20.023504 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:00:20.024701 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m08:00:20.025733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:20.040580 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:00:20.041692 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:00:20.042478 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:00:20.054957 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m08:00:20.057555 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m08:00:20.060472 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m08:00:20.070308 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.071665 [debug] [MainThread]: On master: BEGIN
[0m08:00:20.072733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:20.087330 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:00:20.088597 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.089607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:00:20.100233 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m08:00:20.102722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec8357c70>]}
[0m08:00:20.103836 [debug] [MainThread]: On master: ROLLBACK
[0m08:00:20.105973 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.106780 [debug] [MainThread]: On master: BEGIN
[0m08:00:20.110178 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:00:20.111744 [debug] [MainThread]: On master: COMMIT
[0m08:00:20.113957 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.115149 [debug] [MainThread]: On master: COMMIT
[0m08:00:20.117596 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:00:20.119096 [debug] [MainThread]: On master: Close
[0m08:00:20.120606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:00:20.121948 [info ] [MainThread]: 
[0m08:00:20.129873 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m08:00:20.131246 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m08:00:20.132791 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m08:00:20.133684 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m08:00:20.137694 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m08:00:20.147323 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-15 08:00:20.134498 => 2025-03-15 08:00:20.147155
[0m08:00:20.148593 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m08:00:20.195753 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m08:00:20.204076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.204958 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m08:00:20.205731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:20.220425 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:00:20.221513 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.222358 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m08:00:20.227226 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:00:20.235025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.236408 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m08:00:20.240248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.244666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.245789 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m08:00:20.249081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.274971 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:00:20.276120 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.277107 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:00:20.281372 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:00:20.287636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:00:20.288848 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m08:00:20.292816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:00:20.295440 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-15 08:00:20.149809 => 2025-03-15 08:00:20.295357
[0m08:00:20.296566 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m08:00:20.297957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec83f9bd0>]}
[0m08:00:20.299234 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 60[0m in 0.17s]
[0m08:00:20.302584 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m08:00:20.303901 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m08:00:20.304956 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m08:00:20.306428 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m08:00:20.307310 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m08:00:20.311621 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m08:00:20.320298 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-15 08:00:20.308215 => 2025-03-15 08:00:20.320166
[0m08:00:20.321270 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m08:00:20.328875 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m08:00:20.338480 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.339512 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m08:00:20.340275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:20.354753 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:00:20.355847 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.356947 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m08:00:20.360530 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:00:20.364376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.365406 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m08:00:20.367970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.371837 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.372930 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m08:00:20.375575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.378799 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:00:20.379983 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.380931 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:00:20.384131 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:00:20.387636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:00:20.388663 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m08:00:20.392009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:00:20.394145 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-15 08:00:20.322047 => 2025-03-15 08:00:20.394077
[0m08:00:20.395123 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m08:00:20.396503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec48e9fc0>]}
[0m08:00:20.397521 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 60[0m in 0.09s]
[0m08:00:20.398634 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m08:00:20.399973 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m08:00:20.400922 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m08:00:20.402628 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m08:00:20.403642 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m08:00:20.408127 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m08:00:20.417126 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-15 08:00:20.404429 => 2025-03-15 08:00:20.416959
[0m08:00:20.418496 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m08:00:20.424105 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m08:00:20.432265 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.433371 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m08:00:20.434189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:20.449998 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:00:20.451103 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.451907 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m08:00:20.455438 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:00:20.459288 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.460326 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m08:00:20.463081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.466744 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.467593 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m08:00:20.470200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.473109 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:00:20.474140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.474970 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:00:20.478517 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:00:20.482044 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:00:20.483183 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m08:00:20.486579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:00:20.488797 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-15 08:00:20.419577 => 2025-03-15 08:00:20.488732
[0m08:00:20.489707 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m08:00:20.491117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec6a5b8e0>]}
[0m08:00:20.492272 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 60[0m in 0.09s]
[0m08:00:20.493508 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m08:00:20.495873 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m08:00:20.497104 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m08:00:20.499150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m08:00:20.500155 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m08:00:20.505402 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m08:00:20.523960 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-03-15 08:00:20.501044 => 2025-03-15 08:00:20.523795
[0m08:00:20.525862 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m08:00:20.533137 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m08:00:20.544198 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.545493 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m08:00:20.546521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:20.561566 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:00:20.562761 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.563592 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m08:00:20.573475 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:00:20.577379 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.578349 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m08:00:20.581334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.586038 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.587085 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m08:00:20.589912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:00:20.592952 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:00:20.593873 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.594626 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:00:20.597306 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:00:20.601572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:00:20.602871 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m08:00:20.606770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:00:20.609054 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-03-15 08:00:20.526820 => 2025-03-15 08:00:20.608992
[0m08:00:20.609916 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m08:00:20.611216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882a1d7f-0039-4d4d-86d0-0254e25a675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec83a8d60>]}
[0m08:00:20.612214 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 60[0m in 0.11s]
[0m08:00:20.613370 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m08:00:20.615704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:20.617182 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.618032 [debug] [MainThread]: On master: BEGIN
[0m08:00:20.618935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:00:20.634424 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:00:20.636086 [debug] [MainThread]: On master: COMMIT
[0m08:00:20.637432 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:20.638511 [debug] [MainThread]: On master: COMMIT
[0m08:00:20.641097 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:00:20.642464 [debug] [MainThread]: On master: Close
[0m08:00:20.643872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:20.644871 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m08:00:20.645785 [info ] [MainThread]: 
[0m08:00:20.647067 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m08:00:20.648935 [debug] [MainThread]: Command end result
[0m08:00:20.668441 [info ] [MainThread]: 
[0m08:00:20.670354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:20.671911 [info ] [MainThread]: 
[0m08:00:20.673212 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:00:20.674887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec48ec880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec492eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec83f95a0>]}
[0m08:00:20.676060 [debug] [MainThread]: Flushing usage events


============================== 2025-03-20 09:49:29.832299 | cade4931-0156-499c-ad8f-cd2ca3ded07f ==============================
[0m09:49:29.832299 [info ] [MainThread]: Running with dbt=1.4.7
[0m09:49:29.836005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:49:29.837097 [debug] [MainThread]: Tracking: tracking
[0m09:49:29.849972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe598e99360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe598e997e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe598e993c0>]}
[0m09:49:29.869458 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m09:49:30.069922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:49:30.071233 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m09:49:30.095306 [debug] [MainThread]: 1699: static parser successfully parsed example/specific_movie.sql
[0m09:49:30.126899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59761a9e0>]}
[0m09:49:30.147098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59758bb20>]}
[0m09:49:30.148295 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:49:30.149605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59758bbb0>]}
[0m09:49:30.152517 [info ] [MainThread]: 
[0m09:49:30.155413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:49:30.157575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m09:49:30.171428 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m09:49:30.172681 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m09:49:30.173600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:30.211993 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m09:49:30.214225 [debug] [ThreadPool]: On list_destination_db: Close
[0m09:49:30.217062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m09:49:30.224008 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:49:30.225235 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m09:49:30.226194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:30.240159 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m09:49:30.241421 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:49:30.242349 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m09:49:30.255627 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m09:49:30.258186 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m09:49:30.260914 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m09:49:30.269690 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.270883 [debug] [MainThread]: On master: BEGIN
[0m09:49:30.271845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:30.285187 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:49:30.286404 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.287376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:49:30.297731 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m09:49:30.300300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe595c5ea70>]}
[0m09:49:30.302304 [debug] [MainThread]: On master: ROLLBACK
[0m09:49:30.304748 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.305608 [debug] [MainThread]: On master: BEGIN
[0m09:49:30.308892 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:49:30.310188 [debug] [MainThread]: On master: COMMIT
[0m09:49:30.311244 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.312198 [debug] [MainThread]: On master: COMMIT
[0m09:49:30.314531 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:49:30.315501 [debug] [MainThread]: On master: Close
[0m09:49:30.317053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:30.318284 [info ] [MainThread]: 
[0m09:49:30.337101 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m09:49:30.338700 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m09:49:30.340287 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m09:49:30.341218 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m09:49:30.345255 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m09:49:30.353714 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-03-20 09:49:30.342039 => 2025-03-20 09:49:30.353565
[0m09:49:30.354795 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m09:49:30.399727 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m09:49:30.409016 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.410002 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m09:49:30.410948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:30.424276 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:49:30.425380 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.426258 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m09:49:30.433631 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:49:30.442227 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.443354 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m09:49:30.445979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.451738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.452781 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m09:49:30.455300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.481401 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:49:30.482751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.483691 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:49:30.486900 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:49:30.493659 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:49:30.494740 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m09:49:30.501657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:49:30.504207 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-03-20 09:49:30.355596 => 2025-03-20 09:49:30.504138
[0m09:49:30.505172 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m09:49:30.506539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe595cdc250>]}
[0m09:49:30.507510 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.17s]
[0m09:49:30.510110 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m09:49:30.511465 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m09:49:30.512501 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m09:49:30.513825 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m09:49:30.514676 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m09:49:30.518815 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m09:49:30.526877 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-03-20 09:49:30.515516 => 2025-03-20 09:49:30.526746
[0m09:49:30.527962 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m09:49:30.533456 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m09:49:30.542754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.543808 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m09:49:30.544758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:30.559577 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:49:30.560774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.561643 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m09:49:30.565467 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:49:30.570125 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.571308 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m09:49:30.574333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.578675 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.580410 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m09:49:30.582979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.586077 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:49:30.587252 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.588301 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:49:30.591258 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:49:30.595178 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:49:30.596463 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m09:49:30.601836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:49:30.604452 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-03-20 09:49:30.528783 => 2025-03-20 09:49:30.604384
[0m09:49:30.605501 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m09:49:30.607082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe595ca0ac0>]}
[0m09:49:30.608470 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m09:49:30.609831 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m09:49:30.611130 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m09:49:30.612138 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m09:49:30.613650 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m09:49:30.614617 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m09:49:30.618372 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m09:49:30.626448 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-03-20 09:49:30.615399 => 2025-03-20 09:49:30.626303
[0m09:49:30.627554 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m09:49:30.635250 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m09:49:30.645012 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.646132 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m09:49:30.647110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:30.661412 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:49:30.662643 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.663618 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m09:49:30.667315 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:49:30.672570 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.673862 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m09:49:30.676672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.681204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.682154 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m09:49:30.685165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.688213 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:49:30.689069 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.689906 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:49:30.693422 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:49:30.696849 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:49:30.697845 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m09:49:30.705803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:49:30.708406 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-03-20 09:49:30.628479 => 2025-03-20 09:49:30.708332
[0m09:49:30.709335 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m09:49:30.710798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe597623670>]}
[0m09:49:30.712056 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m09:49:30.713336 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m09:49:30.715258 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m09:49:30.716378 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m09:49:30.717828 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m09:49:30.718723 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m09:49:30.724514 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m09:49:30.732178 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-03-20 09:49:30.719476 => 2025-03-20 09:49:30.732041
[0m09:49:30.733263 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m09:49:30.738756 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m09:49:30.747375 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:49:30.748421 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m09:49:30.749334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:30.762481 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:49:30.763661 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:49:30.764611 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m09:49:30.778747 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:49:30.783587 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:49:30.784662 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m09:49:30.787144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:49:30.789989 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:49:30.790960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:49:30.791850 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:49:30.797158 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:49:30.800332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:49:30.801821 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m09:49:30.804157 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:49:30.806418 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-03-20 09:49:30.734131 => 2025-03-20 09:49:30.806354
[0m09:49:30.807291 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m09:49:30.808769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cade4931-0156-499c-ad8f-cd2ca3ded07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe595c6f790>]}
[0m09:49:30.810144 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m09:49:30.811461 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m09:49:30.814346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:49:30.815575 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.816457 [debug] [MainThread]: On master: BEGIN
[0m09:49:30.817271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:30.830256 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:49:30.831466 [debug] [MainThread]: On master: COMMIT
[0m09:49:30.832409 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:30.833363 [debug] [MainThread]: On master: COMMIT
[0m09:49:30.835678 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:49:30.836888 [debug] [MainThread]: On master: Close
[0m09:49:30.838507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:30.839440 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m09:49:30.840433 [info ] [MainThread]: 
[0m09:49:30.842038 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m09:49:30.843231 [debug] [MainThread]: Command end result
[0m09:49:30.860963 [info ] [MainThread]: 
[0m09:49:30.862311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:30.863844 [info ] [MainThread]: 
[0m09:49:30.865558 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:49:30.867658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59435bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe594361840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe594360be0>]}
[0m09:49:30.869310 [debug] [MainThread]: Flushing usage events
[0m09:49:40.884180 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
